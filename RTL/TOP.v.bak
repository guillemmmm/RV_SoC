
/* Instruction SRAM (read only) Guillem Prenafeta
Memoria de 32b de paraula
*/

`default_nettype none

module TOP
    #(//Paranetres memoria
        parameter data_depth = 32,
        parameter ins_depth = 128,     
        parameter memfile = "blinky.hex")
    (
        input wire i_clk,
        input wire rst
    );


   //Instruction SRAM
   wire [31:0]  ibus_adr;
   wire         ibus_cyc;
   wire [31:0]  ibus_rdt;
   wire         ibus_ack;

   //Data SRAM
   wire [31:0]  dbus_adr;
   wire [31:0]  dbus_dat;
   wire [3:0]   dbus_sel;
   wire         dbus_we;
   wire         dbus_cyc;
   wire [31:0]  dbus_rdt;
   wire         dbus_ack;

   serv_rf_top
   CPU(
    .clk            (i_clk),
    .i_rst          (rst),

    .o_ibus_adr     (ibus_adr),
    .o_ibus_cyc     (ibus_cyc),
    .i_ibus_rdt     (ibus_rdt),
    .i_ibus_ack     (ibus_ack),

    .o_dbus_adr     (dbus_adr),
    .o_dbus_dat     (dbus_dat),
    .o_dbus_sel     (dbus_sel),
    .o_dbus_we      (dbus_we),
    .o_dbus_cyc     (dbus_cyc),
    .i_dbus_rdt     (dbus_rdt),
    .i_dbus_ack     (dbus_ack)

    //extension & MDU
    );

   IMEM
   #(.depth (ins_depth),
     .memfile (memfile)
    )
   IMEM(
    .i_clk          (i_clk),

    .i_wb_adr     (ibus_adr),
    .i_wb_cyc     (ibus_cyc),
    .o_wb_rdt     (ibus_rdt),
    .o_wb_ack     (ibus_ack)  
    );

   DMEM
   #(.depth (data_depth)
    )
   DMEM(
    .i_clk          (i_clk),

    .i_wb_adr     (dbus_adr),
    .i_wb_dat     (dbus_dat),
    .i_wb_sel     (dbus_sel),
    .i_wb_we      (dbus_we),
    .i_wb_cyc     (dbus_cyc),
    .o_wb_rdt     (dbus_rdt),
    .o_wb_ack     (dbus_ack)
    );

endmodule
